"use strict";angular.module("uiWeatherWidget",[]).provider("uiWeatherWidget",function(){var t=this.settings={apiKey:void 0,attributions:[{href:"https://www.wunderground.com",title:"Weather Underground"}],location:"australia/sydney",errorHandler:void 0,dayLimit:7,radar:"",scale:"celcius",url:void 0};this.$get=function(){return{settings:t}}}).component("uiWeatherWidget",{bindings:{apiKey:"@?",attributions:"<?",location:"<?",errorHandler:"&?",dayLimit:"<?",scale:"@?",radar:"@?",url:"@?"},controller:["$http","uiWeatherWidget",function(t,n){var a=this;a.uiWeatherWidget=n,a.loading=!0,a.forecast,a.refresh=function(){Object.keys(n.settings).forEach(function(t){void 0==a[t]&&(a[t]=n.settings[t])}),(a.url||n.settings.url||(a.apiKey||n.settings.apiKey)&&(a.location||n.settings.location))&&(a.status="loading",t({url:a.url||n.settings.url||"http://api.wunderground.com/api/"+(a.apiKey||n.settings.apiKey)+"/forecast10day/q/"+(a.location||n.settings.location||"australia/sydney")+".json",cache:!0}).then(function(t){a.forecast=t.data.forecast.simpleforecast.forecastday.map(function(t,n){return{date:moment.unix(t.date.epoch),dateRelative:0==n?"Today":1==n?"Tomorrow":moment.unix(t.date.epoch).format("dddd"),icon:t.icon,conditions:t.conditions,high:t.high,low:t.low,url:"https://www.wunderground.com/weather/"+(a.location||"australia/sydney")}})}).then(function(){return a.today=a.forecast[0]}).then(function(){return a.status="loaded"}).catch(function(t){if(a.status="error",angular.isFunction(a.errorHandler))a.errorHandler({error:t});else{if(!angular.isFunction(n.settings.errorHandler))throw new Error("Error fetching weather data: "+t.toString());n.settings.errorHandler(t)}}))},a.$onInit=function(){return a.refresh()}}],template:'\n\t\t\t<div class="dropdown">\n\t\t\t\t<button class="dropdown-toggle btn btn-block btn-default media" data-toggle="dropdown">\n\t\t\t\t\t<div ng-if="$ctrl.status == \'loading\'">\n\t\t\t\t\t\t<div class="media-left media-middle">\n\t\t\t\t\t\t\t<i class="fa fa-spinner fa-spin fa-2x"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="media-body">\n\t\t\t\t\t\t\t<h4 class="media-heading">\n\t\t\t\t\t\t\t\tLoading...\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-if="$ctrl.status == \'error\'">\n\t\t\t\t\t\t<div class="media-left media-middle">\n\t\t\t\t\t\t\t<i class="fa fa-exclamation-triangle fa-2x"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div ng-click="$ctrl.refresh()" class="media-body">\n\t\t\t\t\t\t\t<h4 class="media-heading">\n\t\t\t\t\t\t\t\tError loading weather\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t<span class="text-muted">(click to retry)</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ng-if="$ctrl.status == \'loaded\'" class="media">\n\t\t\t\t\t\t<div class="media-left media-middle">\n\t\t\t\t\t\t\t<i class="wi wi-wu-{{$ctrl.today.icon}}"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="media-body text-center">\n\t\t\t\t\t\t\t<h4 class="media-heading">\n\t\t\t\t\t\t\t\t<span class="text-primary">{{$ctrl.scale == \'fahrenheit\' ? $ctrl.today.low.fahrenheit + \'°F\' : $ctrl.today.low.celsius + \'°C\'}}</span>\n\t\t\t\t\t\t\t\t-\n\t\t\t\t\t\t\t\t<span class="text-danger">{{$ctrl.scale == \'fahrenheit\' ? $ctrl.today.high.fahrenheit + \'°F\' : $ctrl.today.high.celsius + \'°C\'}}</span>\n\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t<span class="text-muted">{{$ctrl.today.conditions}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\n\t\t\t\t<div ng-if="$ctrl.status == \'loaded\'" class="dropdown-menu multi-column" ng-class="$ctrl.radar && \'has-radar\'">\n\t\t\t\t\t<ul ng-if="$ctrl.radar" class="dropdown-menu" class="weather-radar">\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t<img ng-src="{{$ctrl.radar}}" width="512px" height="512px"/>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\t\t\t\t\t<ul class="dropdown-menu weather-menu">\n\t\t\t\t\t\t<li class="dropdown-header" ng-if="$ctrl.title">{{$ctrl.title}}</li>\n\t\t\t\t\t\t<li class="divider" ng-if="$ctrl.title" role="separator"></li>\n\n\t\t\t\t\t\t<li ng-repeat="day in $ctrl.forecast | limitTo:($ctrl.dayLimit||$ctrl.uiWeatherWidget.settings.dayLimit||7) track by day.date">\n\t\t\t\t\t\t\t<a href="{{day.url}}" target="_blank" class="media">\n\t\t\t\t\t\t\t\t<div class="media-left media-middle">\n\t\t\t\t\t\t\t\t\t<i class="wi wi-wu-{{day.icon}}"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="media-body">\n\t\t\t\t\t\t\t\t\t<h4 class="media-heading">\n\t\t\t\t\t\t\t\t\t\t<span>{{day.dateRelative}}</span>\n\t\t\t\t\t\t\t\t\t\t<div class="pull-right">\n\t\t\t\t\t\t\t\t\t\t\t<span class="text-primary">{{$ctrl.scale == \'fahrenheit\' ? day.low.fahrenheit + \'°F\' : day.low.celsius + \'°C\'}}</span>\n\t\t\t\t\t\t\t\t\t\t\t-\n\t\t\t\t\t\t\t\t\t\t\t<span class="text-danger">{{$ctrl.scale == \'fahrenheit\' ? day.high.fahrenheit + \'°F\' : day.high.celsius + \'°C\'}}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t\t\t\t<span class="text-muted">{{day.conditions}}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t<div ng-if="$ctrl.attributions && $ctrl.attributions.length" class="weather-attributions-wrapper">\n\t\t\t\t\t\t\t<div class="weather-attributions">\n\t\t\t\t\t\t\t\tdata provided by\n\t\t\t\t\t\t\t\t<span ng-repeat="attribution in $ctrl.attributions">\n\t\t\t\t\t\t\t\t\t<a href="{{attribution.href}}" target="_blank">\n\t\t\t\t\t\t\t\t\t\t{{attribution.title}}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t<span ng-if="!$last">,</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'});